<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <title>Document</title>
</head>
<body onload="DefaultScreen()">
<center>
    <h1 id="Para1">5 Days Weather Forecast</h1>
    <p id="inputContainer">City: <input type="text" id="cityInput"></p>
    <button type="button" onclick="GetInfo()">Click Me</button>
    <h2 id="cityName">---London---</h2>
</center>

<div id = "weatherContainer">
    <div id="iconsContainer">
        <div class = "icons">
            <p class="weather" id="day1"></p>
            <div class="image"><img src="dots.png" class="imgClass" id="img1"></div>
            <p class="minValues" id="day1Min">Loading...</p>
            <p class="maxValues" id="day1Max">Loading...</p>
        </div>
        <div class = "icons">
            <p class="weather" id="day2"></p>
            <div class="image"><img src="dots.png" class="imgClass" id="img2"></div>
            <p class="minValues" id="day2Min">Loading...</p>
            <p class="maxValues" id="day2Max">Loading...</p>
        </div>
        <div class = "icons">
            <p class="weather" id="day3"></p>
            <div class="image"><img src="dots.png" class="imgClass" id="img3"></div>
            <p class="minValues" id="day3Min">Loading...</p>
            <p class="maxValues" id="day3Max">Loading...</p>
        </div>
        <div class = "icons">
            <p class="weather" id="day4"></p>
            <div class="image"><img src="dots.png" class="imgClass" id="img4"></div>
            <p class="minValues" id="day4Min">Loading...</p>
            <p class="maxValues" id="day4Max">Loading...</p>
        </div>
        <div class = "icons">
            <p class="weather" id="day5"></p>
            <div class="image"><img src="dots.png" class="imgClass" id="img5"></div>
            <p class="minValues" id="day5Min">Loading...</p>
            <p class="maxValues" id="day5Max">Loading...</p>
        </div>
    </div>
</div>


<script>
    function GetInfo() {

        var newName = document.getElementById("cityInput");
        var cityName = document.getElementById("cityName");
        cityName.innerHTML = "--"+newName.value+"--";

        fetch('https://api.openweathermap.org/data/2.5/forecast?q='+newName.value+'&appid=40cb7f55adbe6b3302d4780d0ead3739')
            .then(response => response.json())
            .then(data => {

                //Getting the min and max values for each day
                for(i = 0; i<5; i++){
                    document.getElementById("day" + (i+1) + "Min").innerHTML = "Min: " + Number(data.list[i].main.temp_min - 273.15).toFixed(1)+ "°";
                    //Number(1.3450001).toFixed(2); // 1.35
                    document.getElementById("day" + (i+1) + "Max").innerHTML = "Max: " + Number(data.list[i].main.temp_max - 273.15).toFixed(2) + "°";

                    document.getElementById("img" + (i+1)).src = "http://openweathermap.org/img/wn/"+ data.list[i].weather[0].icon +".png";
                }

                console.log(data)


            })

            .catch(err => alert("Something Went Wrong: Try Checking Your Internet Coneciton"))
    }

    function DefaultScreen(){
        document.getElementById("cityInput").defaultValue = "London";
        GetInfo();
    }


    //Getting and displaying the text for the upcoming five days of the week
    var d = new Date();
    var weekday = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday",];

    //Function to get the correct integer for the index of the days array
    function CheckDay(day){
        if(day + d.getDay() > 6){
            return day + d.getDay() - 7;
        }
        else{
            return day + d.getDay();
        }
    }

    for(i = 0; i<5; i++){
        document.getElementById("day" + (i+1)).innerHTML = weekday[CheckDay(i)];
    }
</script>
</body>
</html>